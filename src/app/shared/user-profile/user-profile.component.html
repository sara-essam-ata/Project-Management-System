<section id="user-view" class="p-5">
  <div class="container">
    <div class="row">
      <div class="col-md-8" [ngClass]="{'col-md-11 mx-auto': isUpdate}">
              <div class="title my-4">
                <h3>User Profile</h3>
              </div>
              <form [formGroup]="editProfileForm" (ngSubmit)="onSubmit(editProfileForm)">
              <div class="row">
                <div class="col-md-6">
                  <mat-form-field appearance="fill" class="w-100">
                    <mat-label *ngIf="isUpdate" class="text-secondry">User Name</mat-label>
                    <mat-label *ngIf="isView" class="text-dark">{{user?.userName}}</mat-label>
                    <input formControlName="userName" class="text-main" matInput/>
                  </mat-form-field>

                </div>
                <div class="col-md-6">
                  <mat-form-field appearance="fill" class="w-100">
                    <mat-label *ngIf="isUpdate" class="text-secondry">E-mail</mat-label>
                    <mat-label *ngIf="isView" class="text-dark">{{user?.email}}</mat-label>
                    <input class="text-main"  matInput formControlName="email"/>
                  </mat-form-field>

                </div>
                <div class="col-md-6">
                  <mat-form-field appearance="fill" class="w-100">
                    <mat-label *ngIf="isUpdate" class="text-secondry">Country</mat-label>
                    <mat-label *ngIf="isView" class="text-dark">{{user?.country}}</mat-label>
                    <input class="text-main" formControlName="country" matInput />
                  </mat-form-field>

                </div>
                <div class="col-md-6">
                  <mat-form-field appearance="fill" class="w-100">
                    <mat-label *ngIf="isUpdate" class="text-secondry">Phone Number</mat-label>
                    <mat-label *ngIf="isView" class="text-dark">{{user?.phoneNumber}}</mat-label>
                    <input class="text-main"  matInput formControlName="phoneNumber"/>
                  </mat-form-field>
                </div>
                <div *ngIf="isUpdate" class="col-md-12">
                  <mat-form-field appearance="fill" class="w-100">
                    <mat-label>Confirm Password</mat-label>
                    <input class="text-dark" formControlName="confirmPassword" matInput placeholder="Enter Your Password"
                      [type]="hide ? 'password' : 'text'" />
                    <button type="button" mat-icon-button matSuffix (click)="hide = !hide"
                      [attr.aria-label]="'Hide password'" [attr.aria-pressed]="hide">
                      <mat-icon>{{hide ? "visibility_off" : "visibility"}}</mat-icon>
                    </button>
                  </mat-form-field>
                  <span class="text-danger mb-3" *ngIf="editProfileForm.get('confirmPassword')?.errors &&
                    editProfileForm.get('confirmPassword')?.touched ">
                    <span *ngIf="editProfileForm.get('confirmPassword')?.errors?.['required']">
                      confirmPassword is required
                    </span>
                    <span *ngIf="editProfileForm.get('confirmPassword')?.errors?.['pattern']">
                      confirmPassword must have capital,small letters,sympols,number and pass length(8-16)
                    </span>
                    <span *ngIf="editProfileForm.get('confirmPassword')?.errors?.['invalid']">
                      password and confirm password not match
                    </span>
                  </span>
                </div>
                <div class="col-md-6">
                  <mat-form-field *ngIf="isView" appearance="fill" class="w-100">
                    <mat-label class="text-secondry">Join Date</mat-label>
                    <input class="text-dark"  matInput [value]="user?.group?.creationDate|date:'dd-MM-yyyy'" [disabled]="true"/>
                  </mat-form-field>

                </div>
                <div class="col-md-6">
                  <mat-form-field *ngIf="isView" appearance="fill" class="w-100">
                    <mat-label *ngIf="isUpdate" class="text-secondry">Role</mat-label>
                    <input class="text-dark"  matInput [value]="user?.group?.name" [disabled]="true"/>
                  </mat-form-field>

                </div>
                
                <div *ngIf="isUpdate" class="profile-image">
                  <ngx-dropzone (change)="onSelect($event)" [multiple]="false">
                    <ngx-dropzone-label>
                      <i class="fa-solid fa-upload fa-3x mb-3"></i>
                      <div>
                        Drag & Drop or
                        <span class="text-main">
                          Choose a Item Image to Upload
                        </span>
                      </div>
                    </ngx-dropzone-label>
                    <ngx-dropzone-image-preview ngProjectAs="ngx-dropzone-preview" [removable]="true"
                      (removed)="onRemove(f)" *ngFor="let f of files" [file]="f">
                    </ngx-dropzone-image-preview>
                  </ngx-dropzone>
                </div>
                <div class="d-flex justify-content-end gap-2 my-4">
                  <button *ngIf="isUpdate" type="submit" class="px-4 primary" [disabled]="editProfileForm.invalid">Update Profile</button>
                  <button type="button" class="outline-primary" (click)="isManager()" [routerLink]="isEmployee? '/dashboard/manager/home/': '/dashboard/employee/home/'"> <i class="fa-solid fa-arrow-left pl-2"></i> Back To Home</button>
                </div>
            </div>              
          </form>

      </div>
      <div *ngIf="isView" class="col-md-4">
        <div *ngIf="user?.imagePath">
          <img class="img-fluid" [src]="pathHttps + user?.imagePath" alt="">
        </div>
        <div *ngIf="!user?.imagePath">
          <img class="img-fluid" src="../../../assets/images/dummy-avatar-profile.jpg" alt="">
        </div>
      </div>
    </div>
  </div>
  </section>
